<div *ngIf="asset">
  <div class="expert-details-header global-container-min">
    <div class="global-container">
      <div class="section-title">
        EXPERTS RECOMMENDATIONS ON {{asset.name}}
      </div>
      <div class="section-subtitle">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor<br>
        incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis<br>
        nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
      </div>
      <div fxLayout="column" fxLayoutGap="60px">
        <div fxLayout="row" fxLayoutGap="36px" fxLayoutAlign="space-between center">
          <div class="asset-icon">
            <img [src]="getAssetImgUrl()">
          </div>
          <div fxLayout="column">
            <div class="symbol">{{asset.code}}</div>
            <div class="asset-name">{{asset.name}}</div>
          </div>
          <div fxLayout="column">
            <div class="recommendations">
              {{asset.totalAdvisors}} experts recomend
            </div>
            <div class="followers">
              {{asset.numberOfFollowers}} investors are following
            </div>
          </div>
          <div fxLayout="column">
            <percentage-display [value]="asset.variation24h"></percentage-display>
            Last 24 hours
          </div>
          <div fxLayout="column">
            <percentage-display [value]="asset.variation7d"></percentage-display>
            Last 7 days
          </div>
          <div fxLayout="column">
            <percentage-display [value]="asset.variation30d"></percentage-display>
            Last 30 days
          </div>
          <div class="white-button action-button-sm" *ngIf="asset.following" (click)="onUnfollowAssetClick()">
            Unfollow
          </div>
          <div class="blue-button action-button-sm" *ngIf="!asset.following" (click)="onFollowAssetClick()">
            Follow
          </div>
          <div class="blue-button action-button-sm" *ngIf="showNewAdviceButton" (click)="onNewAdviceClick()">
            Recommend
          </div>
        </div>
        <div fxLayout="row" fxLayoutGap="29px" fxLayoutAlign="space-between start">
          <div class="general-recommendation-box" fxLayout="column" fxFlex="267px" fxLayoutAlign="center center">
            <general-recommendation-tag [value]="asset.mode"></general-recommendation-tag>
            <recommendation-distribution [data]="asset.recommendationDistribution"></recommendation-distribution>
            <div class="disclaimer">
                Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut.
            </div>
          </div>
          <asset-history-chart fxFlex [assetValues]="asset.values"></asset-history-chart>
        </div>
      </div>
    </div>
  </div>
  <div class="global-container">
    <table mat-table [dataSource]="visibleAdvices" class="assets-table">
        <ng-container matColumnDef="expertName">
          <th mat-header-cell *matHeaderCellDef> Expert </th>
          <td mat-cell *matCellDef="let assetAdvisor"> 
            <span class="truncate">{{getAdvisor(assetAdvisor.userId).name}}</span>
          </td>
        </ng-container>
      
        <ng-container matColumnDef="rankin">
          <th mat-header-cell *matHeaderCellDef> Ranking </th>
          <td mat-cell *matCellDef="let assetAdvisor"> 
            <div class="expert-rating">
              <bar-rating [theme]="'fontawesome-o'" [readOnly]="'true'" [rate]="getAdvisor(assetAdvisor.userId).rating" [title]="getAdvisor(assetAdvisor.userId).rating | number: '1.2-2'"></bar-rating>
            </div>
          </td>
        </ng-container>

        <ng-container matColumnDef="value">
          <th mat-header-cell *matHeaderCellDef> Value </th>
          <td mat-cell *matCellDef="let assetAdvisor">  
            At price
            <div>{{assetAdvisor.lastAdviceAssetValue | currency}}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef> Action </th>
          <td mat-cell *matCellDef="let assetAdvisor">
            {{getRecomendationFromType(assetAdvisor.lastAdviceMode)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="position">
          <th mat-header-cell *matHeaderCellDef> Recommendation </th>
          <td mat-cell *matCellDef="let assetAdvisor">
              <div [style.background-color]="getAdviceTypeColor(assetAdvisor.lastAdviceType)">{{getRecommendationFromType(assetAdvisor.lastAdviceType)}}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef> Date </th>
          <td mat-cell *matCellDef="let assetAdvisor">
            <div [title]="assetAdvisor.lastAdviceDate | date: 'medium'">{{assetAdvisor.lastAdviceDate | timeAgo}}</div>
          </td>
        </ng-container>

        <ng-container matColumnDef="followButton">
          <th mat-header-cell *matHeaderCellDef> </th>
          <td mat-cell *matCellDef="let assetAdvisor">
            <div class="white-button action-button-sm" *ngIf="getAdvisor(assetAdvisor.userId).following" (click)="onUnfollowExpertClick($event, getAdvisor(assetAdvisor.userId))">
              UNFOLLOW
            </div>
            <div class="blue-button action-button-sm" *ngIf="!getAdvisor(assetAdvisor.userId).following" (click)="onFollowExpertClick($event, getAdvisor(assetAdvisor.userId))">
              FOLLOW
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row matRipple *matRowDef="let row; columns: displayedColumns;" class="element-row"></tr>
      </table>
      <div class="pagination-link" *ngIf="hasMoreAdvices()" (click)="loadMoreAdvices()">
        LOAD MORE
      </div>
    </div>
</div>
<trending-assets class="global-container-min inverted"></trending-assets>